@Model CUS.Models.CUS
@{
    ViewBag.Title = "Nota de Evolución";

    int edad = 0;
    int meses = 0;
    var fecha = DateTime.Now.ToString("yyyy-MM-ddT00:00:00.000");
    var fechaDT = DateTime.Parse(fecha);

    var today = fechaDT;
    DateTime fnac = (DateTime)Model.FechaNacimiento;
    int Years = 0;
    int Months = 0;
    int Days = 0;

    var nacimiento = string.Format("{0:dd/MM/yyyy}", Model.FechaNacimiento);

    if ((today.Year - fnac.Year) > 0 ||
    (((today.Year - fnac.Year) == 0) && ((fnac.Month < today.Month) ||
    ((fnac.Month == today.Month) && (fnac.Day <= today.Day)))))
    {
        int DaysInBdayMonth = DateTime.DaysInMonth(fnac.Year, fnac.Month);
        int DaysRemain = today.Day + (DaysInBdayMonth - fnac.Day);

        if (today.Month > fnac.Month)
        {
            Years = today.Year - fnac.Year;
            Months = today.Month - (fnac.Month + 1) + Math.Abs(DaysRemain / DaysInBdayMonth);
            Days = (DaysRemain % DaysInBdayMonth + DaysInBdayMonth) % DaysInBdayMonth;
        }
        else if (today.Month == fnac.Month)
        {
            if (today.Day >= fnac.Day)
            {
                Years = today.Year - fnac.Year;
                Months = 0;
                Days = today.Day - fnac.Day;
            }
            else
            {
                Years = (today.Year - 1) - fnac.Year;
                Months = 11;
                Days = DateTime.DaysInMonth(fnac.Year, fnac.Month) - (fnac.Day - today.Day);
            }
        }
        else
        {
            Years = (today.Year - 1) - fnac.Year;
            Months = today.Month + (11 - fnac.Month) + Math.Abs(DaysRemain / DaysInBdayMonth);
            Days = (DaysRemain % DaysInBdayMonth + DaysInBdayMonth) % DaysInBdayMonth;
        }
    }

    if (Years >= 99)
    {
        edad = 99;
    }
    else
    {
        edad = Years;
    }

    meses = Months;
}

<style>
    .modal {
        padding: 0 !important;
    }

    .modal-open .main-wrapper {
        filter: none;
    }

    .nav-tabs.nav-tabs-bottom > li {
        margin-bottom: -1px;
        width: 110px;
        max-width: 110px;
        font-size: 10px;
    }

    .user-tabs .nav-tabs > li > a {
        padding: 5px;
    }

    .table-responsive {
        display: none;
    }


    .profile-header {
        padding-left: 0px;
        margin-bottom: 20px;
    }

</style>

<div class="page-wrapper">
    <div class="content container-fluid">

        <div class="page-header">
            <div class="row">
                <div class="col-sm-12">
                    @*<ul class="breadcrumb">
                            <li class="breadcrumb-item"><a href="@Url.Action(" Index", "Admin" )">Dashboard</a></li>
                            <li class="breadcrumb-item"><a href="@Url.Action(" Index", "HistoriaClinica" )">Historia Clínica</a></li>
                        </ul>*@
                </div>
            </div>
        </div>

        <div class="row">

            <div class="col-sm-12 p-0">
                <div class="profile-header">
                    <div class="row align-items-center">
                        <div class="col-auto profile-image">
                            <a href="#">
                                @*<img class="rounded-circle" alt="User Image" src="~/Content/assets/img/profiles/avatar-04.jpg">*@
                            </a>
                        </div>
                        <div class="col ml-md-n2 profile-user-info">
                            <h10 style="font-weight:bold;">Nombre: @Model.Nombre @Model.PrimerApellido @Model.SegundoApellido </h10>
                            <a id="Nombre"></a><br />
                            <h10 style="font-weight:bold;">Expediente:@Model.Expediente </h10>
                            <a id="Exp"></a><br />
                            <h10 style="font-weight:bold;">Edad: @edad años @meses meses</h10>
                            <a id="Edad"></a><br />
                            <h10 style="font-weight:bold;">Sexo: @Model.Sexo</h10>
                            <a id="Sexo"></a><br />
                                             <h10 style="font-weight:bold;">Fecha Nac.: @nacimiento</h10>
                            <a id="FechaNac"></a>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>
</div>



<!-- Modal -->
<div class="modal fade" id="escalaDolorModal" tabindex="-1" aria-labelledby="escalaDolorModalLabel" aria-hidden="true" data-backdrop="static" data-keyboard="false">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-body p-0">
                <h3 class="modal-title text-center mt-4" id="exampleModalLabel"> <b>Escala del Dolor</b> </h3>
                <div id="container">
                    <svg width="500" height="300" viewBox="0 0 800 400" id="scale">
                        <circle id="YAS" r="150" cx="50%" cy="50%">
                        </circle>
                        <circle id="Yeah" r="150" cx="50%" cy="50%"></circle>
                        <circle id="Mmkay" r="150" cx="50%" cy="50%"></circle>
                        <circle id="Ouch" r="150" cx="50%" cy="50%"></circle>
                        <circle id="Owwwww" r="150" cx="50%" cy="50%"></circle>
                        <circle id="AHHHHHHH" r="150" cx="50%" cy="50%"></circle>
                        <polygon id="needle" points="390, 200 410,200 400, 340" />
                    </svg>
                    <h1>¿Cuánto dolor sientes?</h1>
                    <input id="slider" type="range" min="0" max="100" value="50" />
                    <label id="level" id="value">severe</label>
                    <svg class="faces" viewBox="0 0 105 105" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:1.5;">
                    <g id="YAS">
                    <circle id="face_0" cx="52.5" cy="52.5" r="50" style="fill:rgb(33,166,98);" />
                    <path id="mouth_0" d="M36.391,64.422C36.391,64.422 37.32,82.444 52.5,82.19C67.313,81.942 69.171,64.379 69.085,64.268" style="fill:none;stroke:white;stroke-width:5px;" />
                    </g>
                    <g id="Yeah">
                    <circle id="face_1" cx="52.5" cy="52.5" r="50" style="fill:rgb(141,217,149);" />
                    <path id="mouth_1" d="M36.391,64.422C36.391,64.422 37.32,73.785 52.5,73.532C67.313,73.284 69.171,64.379 69.085,64.268" style="fill:none;stroke:white;stroke-width:5px;" />
                    </g>
                    <g id="Mmkay">
                    <circle id="face_2" cx="52.5" cy="52.5" r="50" style="fill:rgb(231,228,122);" />
                    <path id="mouth_2" d="M36.391,64.422C36.391,64.422 37.421,64.423 52.601,64.17C67.414,63.922 69.171,64.379 69.085,64.268" style="fill:none;stroke:white;stroke-width:5px;" />
                    </g>
                    <g id="Ouch">
                    <circle id="face_3" cx="52.5" cy="52.5" r="50" style="fill:rgb(223,149,51);" />
                    <path id="mouth_3" d="M34.293,69.676C34.293,69.676 37.421,64.423 52.601,64.17C67.414,63.922 72.612,69.21 72.526,69.099" style="fill:none;stroke:white;stroke-width:5px;" />
                    </g>
                    <g id="Owwwww">
                    <circle id="face_4" cx="52.5" cy="52.5" r="50" style="fill:rgb(232,103,13);" />
                    <path id="mouth_4" d="M35.202,72.615C35.202,72.615 37.421,64.423 52.601,64.17C67.414,63.922 73.549,70.769 73.949,71.595" style="fill:none;stroke:white;stroke-width:5px;" />
                    </g>
                    <g id="AHHHHHHH">
                    <circle id="face_5" cx="52.5" cy="52.5" r="50" style="fill:rgb(193,72,37);" />
                    <path id="mouth_5" d="M35.202,75.377C35.202,75.377 37.421,64.423 52.601,64.17C67.414,63.922 73.245,70.671 73.949,75.347" style="fill:none;stroke:white;stroke-width:5px;" />
                    </g>
                    <g id="base">
                    <ellipse id="eye_r" cx="29.31" cy="42.488" rx="3.922" ry="3.923" style="fill:white;" />
                    <ellipse id="eye_l" cx="75.706" cy="42.488" rx="3.922" ry="3.923" style="fill:white;" />
                    </g>
                </svg>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="~/Areas/Admin/assets/js/jquery-3.2.1.min.js"></script>
<script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>

@if (TempData["message_success"] != null)
{
<script>

    Swal.fire({
        icon: 'success',
        title: '@TempData["message_success"]',
        showConfirmButton: false,
        timer: 1600
    })
    
</script>
}